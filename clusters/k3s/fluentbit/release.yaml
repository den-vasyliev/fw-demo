---
apiVersion: helm.toolkit.fluxcd.io/v2
kind: HelmRelease
metadata:
  name: fluent
  namespace: default
spec:
  chart:
    spec:
      chart: ./charts/fluent-bit
      reconcileStrategy: Revision
      sourceRef:
        kind: GitRepository
        name: fluent
        namespace: default
  interval: 5m0s
  values:
    envFrom:
      - secretRef: 
          name: fluent-env
    config:
      outputs: |
        [OUTPUT]
            Name es
            Match kube.*
            Host ${FLUENT_ELASTICSEARCH_HOST}
            Port ${FLUENT_ELASTICSEARCH_PORT}
            HTTP_Passwd ${FLUENT_ELASTICSEARCH_PASSWD}
            HTTP_User ${FLUENT_ELASTICSEARCH_USER}
            Suppress_Type_Name On
            Logstash_Format On
            Retry_Limit False
            tls On
            tls.verify Off

